[px + dt*vx, py + dt*vy, pz + dt*vz, vx - dt*((abx - asx)*(qw^2 + qx^2 - qy^2 - qz^2) - (aby - asy)*(2*qw*qz - 2*qx*qy) + (abz - asz)*(2*qw*qy + 2*qx*qz)), vy - dt*((aby - asy)*(qw^2 - qx^2 + qy^2 - qz^2) + (abx - asx)*(2*qw*qz + 2*qx*qy) - (abz - asz)*(2*qw*qx - 2*qy*qz)), vz - dt*(g + (abz - asz)*(qw^2 - qx^2 - qy^2 + qz^2) - (abx - asx)*(2*qw*qy - 2*qx*qz) + (aby - asy)*(2*qw*qx + 2*qy*qz)), qw + (dt*qx*(wbx - wsx))/2 + (dt*qy*(wby - wsy))/2 + (dt*qz*(wbz - wsz))/2, qx - (dt*qw*(wbx - wsx))/2 - (dt*qy*(wbz - wsz))/2 + (dt*qz*(wby - wsy))/2, qy - (dt*qw*(wby - wsy))/2 + (dt*qx*(wbz - wsz))/2 - (dt*qz*(wbx - wsx))/2, qz - (dt*qw*(wbz - wsz))/2 - (dt*qx*(wby - wsy))/2 + (dt*qy*(wbx - wsx))/2, abx, aby, abz, wbx, wby, wbz] 